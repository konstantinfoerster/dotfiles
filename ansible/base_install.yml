---
- hosts: localhost
  become: true
  gather_facts: false
  vars:
    - main_disk: /dev/sda
    - main_disk_password: "test123"
    - crypted_disk_name: cryptdisk

  tasks:
    - name: Setup hard drive
      import_tasks: tasks/storage.yml
    - name: Prepare base system
      import_tasks: tasks/prepare_base.yml
    - name: Setting host based on given groups
      ansible.builtin.set_fact:
        hostlist: "{{ 'chroot' if 'chroot' in group_names else 'localhost' }}"
        cacheable: yes
    - name: output the content of the 'hostlist' variable
      debug:
        var: hostlist

- import_playbook: main.yml
  tags:
    - always
